first try implementint ch-algorithm
ends in seg fault